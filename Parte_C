#client_sensor.py

HOST = '0.0.0.0'  
PORT = 5000

servidor = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
servidor.bind((HOST, PORT))
servidor.listen(5) #5 conexiones maximas
print(f"Servidor escuchando en {HOST}:{PORT}")

try:
    cliente, direccion = servidor.accept()
    print(f"Cliente conectado desde {direccion}")

    while True:
        lectura = sensor_temp.read()
        if lectura is not None:
            # Convertir lectura a temperatura
            temp_c = lectura * 5 * 20 #Fijarse si se puede ingresar la temp_c directamente
            mensaje = f"{temp_c:.2f}" #Envia al cliente la temperatura en Â°C
            try:
                cliente.send(mensaje.encode('utf-8'))
                print(f"Enviado: {mensaje}")
            except BrokenPipeError:
                print("Cliente desconectado")
                break
except KeyboardInterrupt:
    print("Servidor finalizado")
    #Cerrar conexiones
finally:
    cliente.close()
    servidor.close()
    board.exit()

